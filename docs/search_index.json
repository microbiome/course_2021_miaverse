[["alpha-diversity.html", "7 Alpha diversity 7.1 Visualization 7.2 Statistical testing and comparisons 7.3 Exercises", " 7 Alpha diversity This section demonstrates the analysis of alpha diversity. This quantity measures microbial diversity within each sample. Higher numbers of unique taxa, and more even abundance distributions within a sample yield larger values for alpha diversity. Alpha diversity is a key quantity in a microbiome research. The mia package provides access to a wide variety of alpha diversity indices. For more background information and examples with various alpha diversity indices, see the online book. Let us show how to calculate to different diversity indices, Shannon and Faith. Shannon index reflects how many different taxa there are and how evenly they are distributed within a sample. Faith index additionally takes into account the phylogenetic relations into account. # Indices to be calculated. # Every index is calculated by default if we don&#39;t specify indices. indices &lt;- c(&quot;shannon&quot;, &quot;faith&quot;) # Indices are stored in colData (i.e., sample metadata). We can specify the name # of column, or we can use the default name which is the name of index # (i.e., &quot;shannon&quot; and &quot;faith&quot;). names &lt;- c(&quot;Shannon_diversity&quot;, &quot;Faith_diversity&quot;) # Calculates indices tse &lt;- estimateDiversity(tse, index = indices, name = names) ## Warning: The following values are already present in `colData` and will be ## overwritten: &#39;Shannon_diversity&#39;. Consider using the &#39;name&#39; argument to specify ## alternative names. ## Warning: The following values are already present in `colData` and will be ## overwritten: &#39;Faith_diversity&#39;. Consider using the &#39;name&#39; argument to specify ## alternative names. # Shows the calculated indices knitr::kable(head(colData(tse)[names])) %&gt;% kableExtra::kable_styling(&quot;striped&quot;) %&gt;% kableExtra::scroll_box(width = &quot;100%&quot;) Shannon_diversity Faith_diversity A110 1.765407 7.39224 A12 2.716438 6.29378 A15 3.178103 6.60608 A19 2.891987 6.79708 A21 2.841979 6.65110 A23 2.797942 5.96246 Next we can visualize Shannon index with histogram. # ggplot needs data.frame format as input. # Here, colData is DataFrame, therefore it needs to be converted to data.frame shannon_hist &lt;- ggplot(as.data.frame(colData(tse)), aes(x = Shannon_diversity)) + geom_histogram(bins = 20, fill = &quot;gray&quot;, color = &quot;black&quot;) + labs(x = &quot;Shannon index&quot;, y = &quot;Sample frequency&quot;) shannon_hist Next, let us compare the indices based on a scatter-plot. cross_plot &lt;- ggplot2::ggplot(as.data.frame(colData(tse)), aes(x = Shannon_diversity, y = Faith_diversity)) + geom_point() + # Adds points geom_smooth(method=lm) + # Adds regression line labs(x = &quot;Shannon index&quot;, y = &quot;Faith diversity&quot;) cross_plot ## `geom_smooth()` using formula &#39;y ~ x&#39; ## Warning in grid.Call.graphics(C_polygon, x$x, x$y, index): semi-transparency is ## not supported on this device: reported only once per page 7.1 Visualization Next let us compare indices between different patient status and cohorts. Boxplot is suitable for that purpose. # Creates Shannon boxplot shannon_box &lt;- ggplot(as.data.frame(colData(tse)), aes(x = patient_status, y = Shannon_diversity, fill = cohort)) + geom_boxplot() + theme(title = element_text(size = 12)) # makes titles smaller # Creates Faith boxplot faith_box &lt;- ggplot(as.data.frame(colData(tse)), aes(x = patient_status, y = Faith_diversity, fill = cohort)) + geom_boxplot() + theme(title = element_text(size = 12)) # makes titles smaller # Puts them into same picture gridExtra::grid.arrange(shannon_box, faith_box, nrow = 2) For an alternative visualization, see examples with scater::plotColData. 7.2 Statistical testing and comparisons To further investigate if patient status could explain the variation of Shannon index, let’s do a Wilcoxon test. This is a non-parametric test that doesn’t make specific assumptions about the distribution, unlike popular parametric tests, such as the t test, which assumes normally distributed observations. Wilcoxon test can be used to estimate whether the differences between two groups is statistically significant. Here the ADHD and control groups are not significantly different between groups (p-value is over 0.05). # Wilcoxon test, where Shannon index is the variable that we are comparing. # Patient status - ADHD or control - is the factor that we use for grouping. wilcoxon_shannon &lt;- wilcox.test(Shannon_diversity ~ patient_status, data = colData(tse)) wilcoxon_shannon ## ## Wilcoxon rank sum exact test ## ## data: Shannon_diversity by patient_status ## W = 76, p-value = 0.4879 ## alternative hypothesis: true location shift is not equal to 0 Another test that we can make is to test if ADHD samples differs between different cohorts. From boxplot that we made in previous step, we can see that there might be statistically significant difference between different cohorts. Let’s compare Shannon index of ADHD samples between cohort 2 and cohort 3. As we can see, there is statistically significant difference between the cohorts. # Takes subset of colData. Takes only ADHD samples ADHD_shannon &lt;- colData(tse)[ colData(tse)[, &quot;patient_status&quot;] == &quot;ADHD&quot; , ] # Takes subset of colData. Takes only samples that are in cohort 2 or cohort 3. ADHD_shannon &lt;- ADHD_shannon[ ADHD_shannon[, &quot;cohort&quot;] %in% c(&quot;Cohort_2&quot;, &quot;Cohort_3&quot;) , ] # Wilcoxon test, where Shannon index is the variable that we are comparing. # Cohort - 2 or 3 - is the factor that we use for grouping. wilcoxon_shannon_ADHD_cohorts &lt;- wilcox.test(Shannon_diversity ~ cohort, data = ADHD_shannon) wilcoxon_shannon_ADHD_cohorts ## ## Wilcoxon rank sum exact test ## ## data: Shannon_diversity by cohort ## W = 20, p-value = 0.01587 ## alternative hypothesis: true location shift is not equal to 0 For more examples, see a dedicated section on alpha diversity in the online book. 7.3 Exercises Add the following in the reproducible summary report. Estimate alpha diversity for each sample and draw a histogram. Tip: estimateDiversity Compare the results between two or more alpha diversity indices (visually and/or statistically). See online book for further examples. "]]
